---    
# CHANGEME replace with a sub-repository?
- name: Clone janus demo repository
  ansible.builtin.git:
    accept_hostkey: true
    force: true
    repo: "{{ ocp4_workload_redhat_developer_hub_bootstrap_janus_bootstrap_repo }}"
    dest: "~/demo-setup" # CHANGEME
    version: "{{ ocp4_workload_redhat_developer_hub_bootstrap_janus_bootstrap_repo_revision }}"
  environment:
    GIT_SSL_NO_VERIFY: "true"

- name: Setup Gitops
  ansible.builtin.include_tasks:
    file: ./setup_janus_argocd.yml

- name: Setup Vault
  ansible.builtin.include_tasks:
    file: ./setup_vault.yml

- name: Setup External Secrets Operator
  ansible.builtin.include_tasks:
    file: ./setup_external_secrets.yml

- name: Setup Quay
  ansible.builtin.include_tasks:
    file: ./setup_quay.yml

- name: Setup Orchestrator
  when: ocp4_workload_redhat_developer_hub_bootstrap_orchestrator_enabled
  ansible.builtin.include_tasks:
    file: ./setup_orchestrator.yml
